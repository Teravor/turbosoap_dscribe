

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TurboSOAP Example &mdash; turbosoap_dscribe  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TurboSOAP API" href="API.html" />
    <link rel="prev" title="TurboSOAP_DScribe" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> turbosoap_dscribe
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">TurboSOAP Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#turbosoapspecie">TurboSOAPSpecie</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparing-environments">Comparing environments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="API.html">TurboSOAP API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">turbosoap_dscribe</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>TurboSOAP Example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="turbosoap-example">
<h1>TurboSOAP Example<a class="headerlink" href="#turbosoap-example" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>Instantiating the TurboSOAP descriptor is done as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dscribe.descriptors.turbosoap</span> <span class="kn">import</span> <span class="n">TurboSOAP</span>

<span class="n">turbosoap</span> <span class="o">=</span> <span class="n">TurboSOAP</span><span class="p">(</span><span class="n">species</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span> <span class="n">lmax</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p>After creation the TurboSOAP descriptor can applied to atomic structures:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Water molecule</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">molecule</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span>

<span class="c1">#Create TurboSOAP output for water</span>
<span class="n">turbosoap_water</span> <span class="o">=</span> <span class="n">turbosoap</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">water</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">turbosoap_water</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">turbosoap_water</span><span class="p">)</span>
</pre></div>
</div>
<p>The TurboSOAP descriptor uses a lot of default parameters which are decent defaults but might not be
physically or computationally optimal paremeters to represent atomic environments in specific cases.
The parameters enable good accuracy and quick computation times if they are chosen judiciously.</p>
<p>In order to tune the parameters we need to use TurboSOAPSpecie to define them.</p>
</div>
<div class="section" id="turbosoapspecie">
<h2>TurboSOAPSpecie<a class="headerlink" href="#turbosoapspecie" title="Permalink to this headline">¶</a></h2>
<p>TurboSOAPSpecie can be used to define all the per-species parameters used by TurboSOAP.
A more involved example using TurboSOAPSpecies:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">turbosoap_dscribe</span> <span class="kn">import</span> <span class="n">TurboSOAPSpecie</span>

<span class="c1"># More control on each species</span>
<span class="n">H_config</span> <span class="o">=</span> <span class="n">TurboSOAPSpecie</span><span class="p">(</span><span class="n">rcut</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">nmax</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">atom_sigma_r</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">atom_sigma_t</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">atom_sigma_r_scaling</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">atom_sigma_t_scaling</span> <span class="o">=</span> <span class="mf">0.025</span><span class="p">)</span>
<span class="n">O_config</span> <span class="o">=</span> <span class="n">TurboSOAPSpecie</span><span class="p">(</span><span class="n">rcut</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">nmax</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">atom_sigma_r</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">atom_sigma_t</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="n">atom_sigma_r_scaling</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">atom_sigma_t_scaling</span> <span class="o">=</span> <span class="mf">0.020</span><span class="p">)</span>

<span class="n">turbosoap</span> <span class="o">=</span> <span class="n">TurboSOAP</span><span class="p">(</span><span class="n">species</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="n">H_config</span><span class="p">,</span>  <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="n">O_config</span><span class="p">},</span> <span class="n">lmax</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="turbosoap_dscribe.TurboSOAPSpecie.__init__">
<code class="sig-prename descclassname">TurboSOAPSpecie.</code><code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rcut</span></em>, <em class="sig-param"><span class="n">nmax</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">atom_sigma_r</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">atom_sigma_t</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">atom_sigma_r_scaling</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">atom_sigma_t_scaling</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">radial_enhancement</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">amplitude_scaling</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">central_weight</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">global_scaling</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">nf</span><span class="o">=</span><span class="default_value">4.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#turbosoap_dscribe.TurboSOAPSpecie.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rcut</strong> (<em>float</em>) – A cutoff for local region in angstroms. Should be bigger
than the buffer.</p></li>
<li><p><strong>nmax</strong> (<em>int</em>) – Number of radial basis functions.</p></li>
<li><p><strong>buffer</strong> (<em>float</em>) – Width of buffer region where atomic density field will decay
to zero</p></li>
<li><p><strong>atom_sigma_r</strong> (<em>float</em>) – Width of radial sigma (in Angstrom) at the origin</p></li>
<li><p><strong>atom_sigma_r_scaling</strong> (<em>float</em>) – Radial-scaling parameter for radial sigma (dimensionless)</p></li>
<li><p><strong>atom_sigma_t</strong> (<em>float</em>) – Width of angular sigma (in Angstrom) at the origin</p></li>
<li><p><strong>atom_sigma_t_scaling</strong> (<em>float</em>) – Radial-scaling parameter for angular sigma (dimensionless)</p></li>
<li><p><strong>radial_enhancement</strong> (<em>integer</em>) – Distant atomic densities get weighted by the integral of
a Gaussian located at the same position times the radial
coordinated raised to this power. It must be 0, 1 or 2</p></li>
<li><p><strong>amplitude_scaling</strong> (<em>float</em>) – The atomic densities get weighted, according to the position
of their atomic centers, by a radial function that decays to
zero at the cutoff according to a power law, where this
parameter is the exponent</p></li>
<li><p><strong>global_scaling</strong> (<em>float</em>) – Multiplicative factor for the whole atomic density fieldç
corresponding to this species</p></li>
<li><p><strong>central_weight</strong> (<em>float</em>) – Scaling factor for the atomic density field corresponding to
the central atom, when the centra latom is of this species</p></li>
<li><p><strong>nf</strong> (<em>float</em>) – Decay parameter of the exponential within the buffer region</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="comparing-environments">
<h2>Comparing environments<a class="headerlink" href="#comparing-environments" title="Permalink to this headline">¶</a></h2>
<p>A quick example on how to compare environments. The quantity of interest is the similarity kernel between
two atomic environments which is between zero and one. Zero indicates that environments are not similar and one indicates that
the environments are the same. The kernel is computed as a dot product between two TurboSOAP vectors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dscribe.descriptors.turbosoap</span> <span class="kn">import</span> <span class="n">TurboSOAP</span>
<span class="kn">from</span> <span class="nn">ase.build</span> <span class="kn">import</span> <span class="n">molecule</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">turbosoap</span> <span class="o">=</span> <span class="n">TurboSOAP</span><span class="p">(</span><span class="n">species</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span> <span class="n">lmax</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">molecule</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span>
<span class="n">turbosoap_water</span> <span class="o">=</span> <span class="n">turbosoap</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">water</span><span class="p">)</span>
<span class="c1">#Compare similarity of hydrogen and oxygen environments</span>
<span class="c1">#Index 0 has oxygen atom and indices 1,2 have hydrogen atoms.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">water</span><span class="o">.</span><span class="n">get_chemical_symbols</span><span class="p">())</span>

<span class="c1">#Compare hydrogen environments. Should be close to one </span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">turbosoap_water</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">turbosoap_water</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

<span class="c1">#Compare oxygen-hydrogen. </span>
<span class="c1">#Should be quite small as the hydrogen and oxygen environments are quite different</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">turbosoap_water</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">turbosoap_water</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="API.html" class="btn btn-neutral float-right" title="TurboSOAP API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="TurboSOAP_DScribe" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020 Miguel Caro

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>